<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Carbon Footprint Dashboard</title>

  <style>
    body {
      font-family: "Segoe UI", Arial, sans-serif;
      margin: 0;
      padding: 30px;
      background: linear-gradient(135deg, #e8f5e9, #f1f8e9);
      color: #333;
    }

    h1 {
      text-align: center;
      margin-bottom: 30px;
      color: #1b5e20;
    }

    section {
      background: #ffffff;
      border-radius: 12px;
      padding: 20px 25px;
      margin-bottom: 25px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    section:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 28px rgba(0, 0, 0, 0.12);
    }

    h2 {
      margin-top: 0;
      margin-bottom: 15px;
      color: #2e7d32;
      border-bottom: 2px solid #c8e6c9;
      padding-bottom: 6px;
    }

    input {
      width: 100%;
      padding: 10px 12px;
      margin: 8px 0;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 14px;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }

    input:focus {
      outline: none;
      border-color: #43a047;
      box-shadow: 0 0 0 2px rgba(67, 160, 71, 0.2);
    }

    button {
      background: linear-gradient(135deg, #43a047, #66bb6a);
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 10px 16px;
      font-size: 14px;
      cursor: pointer;
      margin-top: 10px;
      transition: background 0.2s ease, transform 0.1s ease;
    }

    button:hover {
      background: linear-gradient(135deg, #388e3c, #4caf50);
      transform: scale(1.03);
    }

    button:active {
      transform: scale(0.98);
    }

    ul {
      list-style: none;
      padding-left: 0;
      margin-top: 10px;
    }

    li {
      background: #f9fbe7;
      margin-bottom: 8px;
      padding: 10px 12px;
      border-radius: 6px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 14px;
    }

    li button {
      padding: 6px 12px;
      font-size: 12px;
      margin: 0;
    }

    #alert {
      margin-top: 10px;
      font-weight: 600;
      color: #d32f2f;
    }

    @media (max-width: 600px) {
      body {
        padding: 15px;
      }

      section {
        padding: 15px;
      }
    }
  </style>
</head>

<body>

<h1>üå± Carbon Footprint Dashboard</h1>

<section>
  <h2>1Ô∏è‚É£ Login</h2>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button onclick="login()">Login</button>
</section>

<section>
  <h2>2Ô∏è‚É£ Carbon Survey</h2>
  <input id="transport" placeholder="Transport Mode">
  <input id="diet" placeholder="Diet Type">
  <input id="energy" type="number" placeholder="Energy Usage">
  <input id="freq" placeholder="Frequency">
  <button onclick="submitSurvey()">Submit Survey</button>
  <p id="alert"></p>
</section>

<section>
  <h2>üìä Carbon History</h2>
  <ul id="historyList"></ul>
  <button onclick="loadHistory()">Load History</button>
</section>

<section>
  <h2>3Ô∏è‚É£ Set Goal</h2>
  <input id="target" type="number" placeholder="Target Carbon">
  <button onclick="createGoal()">Create Goal</button>
</section>

<section>
  <h2>üèÜ Leaderboard</h2>
  <ul id="leaderboard"></ul>
  <button onclick="loadLeaderboard()">Load Leaderboard</button>
</section>

<section>
  <h2>üõí Eco Marketplace</h2>
  <ul id="marketplace"></ul>
  <button onclick="loadMarketplace()">Load Marketplace</button>
</section>

<script>
const USER_ID = 7;

function login() {
  fetch("http://localhost:8080/api/users/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      email: email.value,
      password: password.value
    })
  })
  .then(r => r.json())
  .then(() => alert("Login successful"));
}

function submitSurvey() {
  fetch("http://localhost:8080/api/survey/" + USER_ID, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      transportMode: transport.value,
      dietType: diet.value,
      energyUsage: energy.value,
      frequency: freq.value
    })
  })
  .then(r => r.text())
  .then(msg => {
    alert(msg);
    if (energy.value > 20) {
      alert.innerText = "‚ö† High carbon usage detected!";
    } else {
      alert.innerText = "";
    }
  });
}

function loadHistory() {
  const historyList = document.getElementById("historyList");
  historyList.innerHTML = "";

  fetch("http://localhost:8080/api/carbon/history/" + USER_ID)
    .then(r => r.json())
    .then(data => {
      data.forEach(l => {
        let li = document.createElement("li");
        li.innerText = l.logDate + " ‚Üí " + l.carbonAmount;
        historyList.appendChild(li);
      });
    })
    .catch(err => {
      alert("Error loading history");
      console.error(err);
    });
}

function createGoal() {
  fetch("http://localhost:8080/api/goals", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      targetCarbon: target.value,
      user: { id: USER_ID }
    })
  })
  .then(r => r.json())
  .then(() => alert("Goal created successfully"));
}

function loadLeaderboard() {
  const list = document.getElementById("leaderboard");
  list.innerHTML = "";

  fetch("http://localhost:8080/api/leaderboard")
    .then(r => r.json())
    .then(data => {
      data.forEach(u => {
        let li = document.createElement("li");
        li.innerText = u.userName + " ‚Üí " + u.badgeCount + " badges";
        list.appendChild(li);
      });
    });
}

function loadMarketplace() {
  const list = document.getElementById("marketplace");
  list.innerHTML = "";

  fetch("http://localhost:8080/api/marketplace")
    .then(r => r.json())
    .then(items => {
      items.forEach(i => {
        let li = document.createElement("li");
        li.innerHTML =
          i.itemName + " (‚Çπ" + i.price + ") " +
          "<button onclick='buy(" + i.id + ")'>Buy</button>";
        list.appendChild(li);
      });
    });
}

function buy(itemId) {
  fetch(
    "http://localhost:8080/api/transactions?userId=" +
      USER_ID +
      "&itemId=" +
      itemId,
    { method: "POST" }
  )
  .then(r => r.json())
  .then(() => alert("Transaction successful"));
}
</script>

</body>
</html>



